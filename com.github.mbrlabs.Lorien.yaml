app-id: com.github.mbrlabs.Lorien
runtime: org.freedesktop.Platform
runtime-version: '21.08'
sdk: org.freedesktop.Sdk
base: org.godotengine.godot.BaseApp
base-version: '3.4'
command: Lorien
finish-args:
  - --device=dri
  - --filesystem=home
  - --share=ipc
  - --socket=pulseaudio
  - --socket=x11
modules:
  - name: lorien
    buildsystem: simple
    build-commands:
      - mv ${FLATPAK_DEST}/bin/{godot-runner,Lorien}
      - install -Dm644 Lorien.pck -t ${FLATPAK_DEST}/bin/
      - install -Dm644 ${FLATPAK_ID}.desktop -t ${FLATPAK_DEST}/share/applications/
      - install -Dm644 ${FLATPAK_ID}.png -t ${FLATPAK_DEST}/share/icons/hicolor/64x64/apps/
      - install -Dm644 ${FLATPAK_ID}.metainfo.xml -t ${FLATPAK_DEST}/share/metainfo/
      - install -Dm644 ${FLATPAK_ID}.mimetype.xml -t ${FLATPAK_DEST}/share/mime/packages/
    sources:
      - type: archive
        url: https://github.com/mbrlabs/Lorien/releases/download/v0.5.0/Lorien_0.5.0_Linux.tar.xz
        sha256: ea8820088b07ed3bc79121de8dffbcc1cd4402990af663b0c2c62718d2585658
        x-checker-data:
          is-main-source: true
          type: json
          url: https://api.github.com/repos/mbrlabs/Lorien/releases/latest
          version-query: .tag_name | sub("^v"; "")
          url-query: .assets[] | select(.name=="Lorien_" + $version + "_Linux.tar.xz") | .browser_download_url
      - type: file
        path: com.github.mbrlabs.Lorien.desktop
      - type: file
        url: https://github.com/mbrlabs/Lorien/raw/main/images/lorien.png
        sha256: fcdd491ea3fa4e3ea0c43b15f2c3b92974f550c97abe5b081ac1cab614612851
        dest-filename: com.github.mbrlabs.Lorien.png
      - type: file
        path: com.github.mbrlabs.Lorien.metainfo.xml
      - type: file
        path: com.github.mbrlabs.Lorien.mimetype.xml
